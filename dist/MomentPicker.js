!function(a,b){var c="MomentPicker",d=moment().startOf("day"),e=navigator.language||navigator.userLanguage||"en",f={date:d,locale:e,level:0,style:{selected:"selected",current:"current"}};a.fn[c]=function(b){var e=a(this).data(c);return e?e:this.each(function(){var e,g=a.extend(!0,{},f,b);moment.locale(g.locale),g.date.locale(g.locale);var h=g.date,i=h.clone(),j=a(this),k=g.level;if(j.is('input[type="text"]')||j.is('input[type="date"]')){var l=j;l.on("click focus",function(){B()});var m=a('<div class="mp">');m.hide(),j.after(m),j=m,a(document).on("mousedown",function(a){j.is(a.target)||0!==j.has(a.target).length||j.hide()})}else j.addClass("mp");j.html(['<div class="mp-header">','<a class="mp-prev"></a>','<a class="mp-current"></a>','<a class="mp-next"></a>',"</div>",'<div class="mp-body"></div>'].join(""));var n=j.children("div.mp-header"),o=j.children("div.mp-body"),p=n.children("a.mp-next"),q=n.children("a.mp-prev"),r=n.children("a.mp-current"),s=function(){return!1},t=s,u=s,v=s,w=s,x=s,y=s,z=s,A=s,B=function(){""!==l.val()&&I(moment(l.val(),"L")),O(2),j.show()},C=function(a){a instanceof Function?z=a:!function(){var b=moment(a);moment.isMoment(b)&&(b.startOf("day"),z=function(){return b.clone()})}(),x=function(a){return a<z().year()},v=function(a){return a.clone().startOf("month")<z().startOf("month")},t=function(a){return a<z()};var b=z();b>i?I(b):O()},D=function(a){a instanceof Function?A=a:!function(){var b=moment(a);moment.isMoment(b)&&(b.startOf("day"),A=function(){return b.clone()})}(),y=function(a){return a>A().year()},w=function(a){return a.clone().startOf("month")>A().startOf("month")},u=function(a){return a>A()};var b=A();i>b?I(b):O()},E=function(b){var c=a.Event(b);c.api=e,j.trigger(c)},F=function(a){return!x(a)&&!y(a)},G=function(a){return!t(a)&&!u(a)},H=function(a){return!v(a)&&!w(a)},I=function(){if(arguments.length>0){var a=moment(arguments[0]);return a.isValid()&&(a.startOf("day"),G(a)&&(i=a,E("pick"),h=i.clone(),O())),e}return i.clone()},J=function(){var a=h.year(),b=a+12,c="";for(r.text(a+" - "+(b-1));b>a;){var e=[];a===d.year()&&e.push(g.style.current),a===i.year()&&e.push(g.style.selected);var f=F(a)?"a":"span";c+="<"+f+' data-year="'+a+'" class="'+e.join(" ")+'">'+a+"</"+f+">",a++}o.html(c),E("renderYears")},K=function(){var a=h.clone().startOf("y"),b=a.clone().add(12,"M"),c="";for(r.text(a.year());b>a;){var e=[];a.format("M-YYYY")===d.format("M-YYYY")&&e.push(g.style.current),a.format("M-YYYY")===i.format("M-YYYY")&&e.push(g.style.selected);var f=H(a)?"a":"span";c+="<"+f+' data-month="'+a.format("M-YYYY")+'" class="'+e.join(" ")+'">'+a.format("MMM")+"</"+f+">",a.add(1,"M")}o.html(c),E("renderMonths")},L=function(){var a=h.clone().startOf("w"),b=a.clone().add(1,"w"),c='<div class="week">';for(r.text(h.format("MMMM YYYY"));b>a;)c+="<span>"+a.format("ddd")+"</span>",a.add(1,"d");c+="</div>",a=h.clone().startOf("M").startOf("w"),b=a.clone().add(42,"d"),c+='<div class="month">';for(var e=!1;b>a;){var f=[];a.format("D-M-YYYY")===d.format("D-M-YYYY")&&f.push(g.style.current),a.format("D-M-YYYY")===i.format("D-M-YYYY")&&f.push(g.style.selected);var j=G(a)?"a":"span";a.month()!==h.month()?f.push(e?"mp-next":"mp-prev"):e=!0,c+="<"+j+' data-day="'+a.format("D-M-YYYY")+'" class="'+f.join(" ")+'">'+a.date()+"</"+j+">",a.add(1,"d")}c+="</div>",o.html(c),E("renderDays")},M=[{years:12},{years:1},{months:1}],N=[J,K,L],O=function(){arguments.length>0&&(k=Math.max(arguments[0],g.level)),j.removeClass("top"),k===g.level&&j.addClass("top"),N[k](),E("render")},P=function(){var a=Object.keys(M[k])[0],b=M[k][a];h.add(b,a),O(),E("showNext")},Q=function(){var a=Object.keys(M[k])[0],b=M[k][a];h.subtract(b,a),O(),E("showPrev")};p.click(P),q.click(Q),r.click(function(){O(Math.max(0,--k))}),o.on("click","a[data-year]",function(){h.year(a(this).data("year")),O(1)}),o.on("click","a[data-month]",function(){var b=moment(a(this).data("month"),"M-YYYY");h.month(b.month()).year(b.year()),O(2)}),o.on("click","a[data-day]",function(){I(moment(a(this).data("day"),"D-M-YYYY")),l&&(l.val(i.format("L")),j.hide())});var R=function(){return arguments.length>0?(C(arguments[0]),e):z()},S=function(){return arguments.length>0?(D(arguments[0]),e):A()};e={val:I,next:P,prev:Q,min:R,max:S,renderYears:function(){O(0)},renderMonths:function(){O(1)},renderDays:function(){O(2)}},g.hasOwnProperty("min")&&C(g.min),g.hasOwnProperty("max")&&D(g.max),j.data(c,e),E("ready"),O()})}}(jQuery);